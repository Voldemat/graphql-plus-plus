type File {
    id: UUID!
    user: User!
    filename: String!
    mimeType: String
    previewUrl: Url
    sizeInBytes: Int64!
    createdAt: Datetime!
}

type SearchFile {
    file: File!
    tags: [Tag!]!
}

type SearchFileList {
    files: [SearchFile!]!
}

enum EFileField {
    NAME
    MIMETYPE
    SIZE_IN_BYTES
    AUTHOR_NAME
    TAGS
    CREATED_AT
}

input FileSortBy {
    field: EFileField!
    direction: ESortDirection!
}

union GetFilesResponse = SearchFileList | ErrorUnknownTags
union RetrieveFileResponse = SearchFile | ErrorUnknownFile
union GetFileURLResponse = UrlObject | ErrorUnknownFile
union IsAllowedToDownloadResponse = BooleanObject | ErrorUnknownFile

input NumberRange {
    startAt: Float
    endAt: Float
}

input FilterDateRange {
    startAt: Datetime
    endAt: Datetime
}

input Filter {
    columnId: UUID!
    numberRange: NumberRange
    dateRange: FilterDateRange
    listValues: [String!]
}

extend type Query {
    getFiles(
        skip: Int!,
        limit: Int!,
        tagIds: [UUID!]!,
        filters: [Filter!]!,
        sortBy: FileSortBy!
    ): GetFilesResponse! @authenticated
    getFilesCount(
        tagIds: [UUID!]!,
        filters: [Filter!]!
    ): IntObjectOrErrorUnknownTags! @authenticated

    getUploadedFiles(
        skip: Int!,
        limit: Int!,
        sortBy: FileSortBy!
    ): [SearchFile!]! @authenticated
    getUploadedFilesCount: Int! @authenticated

    getFileURL(id: UUID!): GetFileURLResponse! @authenticated
    retrieveFile(id: UUID!): RetrieveFileResponse! @authenticated
    isAllowedToDownload(id: UUID!): IsAllowedToDownloadResponse! @authenticated
}
