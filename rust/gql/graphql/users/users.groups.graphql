type Group {
    id: UUID!
    name: String!
    first10Tags: [Tag!]!
    limitOfDownloadsPerDay: Int!
}

input GroupIn {
    name: String!
    tagIds: [UUID!]!
    limitOfDownloadsPerDay: Int!
}

enum EGroupField {
    NAME
    CREATED_AT
    LIMIT_OF_DOWNLOADS_PER_DAY
}

input GetGroupsSortBy {
    field: EGroupField!
    direction: ESortDirection!
}

type ErrorGroupNotFound {
    a: Boolean
}
type ErrorInvalidGroupName {
    a: Boolean
}
type ErrorInvalidLimitOfDownloadsPerDay {
    a: Boolean
}
type ErrorUnknownUsers {
    userIds: [UUID!]!
}
union CreateGroupError =
    ErrorAlreadyExists |
    ErrorInvalidGroupName |
    ErrorInvalidLimitOfDownloadsPerDay |
    ErrorUnknownUsers |
    ErrorUnknownTags
union EditGroupError = 
    ErrorAlreadyExists |
    ErrorInvalidGroupName |
    ErrorInvalidLimitOfDownloadsPerDay |
    ErrorUnknownTags |
    ErrorGroupNotFound
union ErrorGroupNotFoundOrErrorNotFound =
    ErrorGroupNotFound |
    ErrorNotFound
extend type Mutation {
    createGroup(groupIn: GroupIn!, userIds: [UUID!]!): CreateGroupError @admin @authenticated
    editGroup(id: UUID!, groupIn: GroupIn!): EditGroupError @admin @authenticated
    deleteGroup(id: UUID!): ErrorGroupNotFound @admin @authenticated
    addUserToGroup(
        groupId: UUID!,
        userId: UUID!
    ): ErrorGroupNotFoundOrErrorNotFound @admin @authenticated
    removeUserFromGroup(
        groupId: UUID!,
        userId: UUID!
    ): ErrorGroupNotFoundOrErrorNotFound @admin @authenticated
}

enum EGroupUsersField {
    NAME
    EMAIL
}

input GetGroupUsersSortBy {
    field: EGroupUsersField!
    direction: ESortDirection!
}

type UsersList {
    users: [User!]!
}

union GetGroupTagsResponse =
    TagList |
    ErrorNotFound
union GetGroupUsersResponse =
    UsersList |
    ErrorNotFound
union GetGroupUsersTotalResponse =
    IntObject |
    ErrorNotFound
union RetrieveGroupResponse =
    Group |
    ErrorNotFound

type GroupUser {
    inGroup: Boolean!
    user: User!
}

type GroupUserList {
    users: [GroupUser!]!
}

union GetGroupUsersAndUsersResponse =
    GroupUserList |
    ErrorGroupNotFound

extend type Query {
    getGroupTags(
        id: UUID!, skip: Int!, limit: Int!
    ): GetGroupTagsResponse! @admin @authenticated
    getGroups(
        skip: Int!,
        limit: Int!,
        sortBy: GetGroupsSortBy!
    ): [Group!]! @admin @authenticated
    getGroupsTotal: Int! @admin @authenticated
    getGroupUsers(
        groupId: UUID!,
        skip: Int!,
        limit: Int!,
        sortBy: GetGroupUsersSortBy!
    ): GetGroupUsersResponse! @admin @authenticated
    getGroupUsersTotal(
        groupId: UUID!
    ): GetGroupUsersTotalResponse! @admin @authenticated
    retrieveGroup(id: UUID!): RetrieveGroupResponse! @admin @authenticated
    getGroupUsersAndUsers(
        groupId: UUID!,
        skip: Int!,
        limit: Int!,
        query: String,
        sortBy: GetUsersSortBy!
    ): GetGroupUsersAndUsersResponse! @admin @authenticated
}
