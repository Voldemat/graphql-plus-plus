union TagValue = FloatObject | DatetimeObject | StringObject

type Tag {
    id: UUID!
    tag: String!
    isFavourite: Boolean!
    hasChildren: Boolean!
    isApproved: Boolean!
    value: TagValue
}

type TagInfo {
    tag: String!
    parentTag: Tag
}

type TagList {
    list: [Tag!]!
}

type ErrorUnknownTags {
    tagIds: [UUID!]!
}

enum EUsersTagField {
    TAG
    USERS_COUNT
    CREATED_AT
}

input UsersTagSortBy {
    field: EUsersTagField!
    direction: ESortDirection!
}

type UsersTag {
    tag: Tag!
    usersCount: Int!
    createdAt: Datetime!
}

union GetTagsResponse = TagList | ErrorUnknownTags
union GetPathToTagResponse = StringList | ErrorUnknownTags
union IntObjectOrErrorUnknownTags = IntObject | ErrorUnknownTags
union GetTagInfoResponse = TagInfo | ErrorNotFound

extend type Query {
    searchTags(query: String!): [Tag!]! @authenticated
    getMyTags(
        skip: Int!,
        limit: Int!
    ): [Tag!]! @authenticated
    getMyTagsCount: Int! @authenticated
    getTags(
        skip: Int!,
        limit: Int!,
        parentTagId: UUID,
        query: String
    ): GetTagsResponse! @authenticated
    getTagsCount(
        parentTagId: UUID,
        query: String
    ): IntObjectOrErrorUnknownTags! @authenticated
    getPopularTags(
        skip: Int!,
        limit: Int!,
    ): [Tag!]! @authenticated
    getPathToTag(tagId: UUID!): GetPathToTagResponse! @authenticated
    isTagExists(tag: String!): Boolean! @authenticated
    getUsersTags(
        skip: Int!,
        limit: Int!,
        query: String,
        sortBy: UsersTagSortBy!,
    ): [UsersTag!]! @admin @authenticated
    getUsersTagsCount(query: String): Int! @admin @authenticated
    getTagChildren(tagId: UUID!): GetTagsResponse! @admin @authenticated
    getTagInfo(tagId: UUID!): GetTagInfoResponse! @authenticated
}
